% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utilities.R
\name{lopt_estimate}
\alias{lopt_estimate}
\title{Estimate the optimal scaling parameter for latent confounding}
\usage{
lopt_estimate(A, X, y, weights, r = 1, multi_rank = TRUE)
}
\arguments{
\item{A}{The adjacency matrix of the input network}

\item{X}{The design matrix}

\item{y}{The response vector}

\item{weights}{A logical vector indicating which nodes have observed outcomes}

\item{r}{The rank for low-rank approximation (default is 1)}

\item{multi_rank}{Logical; whether to estimate \eqn{\sigma_a} using multiple singular values (default is \code{TRUE})}
}
\value{
A numeric scalar \eqn{\ell}, representing the optimal scale for debiasing or penalization in downstream estimation
}
\description{
Computes the theoretically motivated scaling factor \eqn{\ell} that balances
the contribution of latent confounding effects and observed noise. This is based 
on a two-stage estimation of centralities and regression coefficients. The procedure 
adjusts for the proportion of observed outcomes.
}
